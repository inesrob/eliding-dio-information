<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE rfc SYSTEM "rfc2629-xhtml.ent">

<?rfc toc="yes"?>
<?rfc tocompact="yes"?>
<?rfc tocdepth="3"?>
<?rfc tocindent="yes"?>
<?rfc symrefs="yes"?>
<?rfc sortrefs="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>
<?rfc compact="no"?>
<?rfc subcompact="no"?>
<?rfc authorship="yes"?>
<?rfc tocappendix="yes"?>
<rfc  xmlns:xi="http://www.w3.org/2001/XInclude" category="info" ipr='trust200902' tocInclude="true"  obsoletes="" updates="6550" submissionType="IETF" xml:lang="en" version="3" docName="draft-thubert-roll-eliding-dio-information-00" >

<front>

   <title abbrev='Eliding RPL Info'>Eliding and Querying RPL Information</title>
   <author initials='P' surname='Thubert' fullname='Pascal Thubert' role='editor'>
      <organization abbrev='Cisco Systems'>Cisco Systems, Inc</organization>
      <address>
         <postal>
            <street>Building D</street>
            <street>45 Allee des Ormes - BP1200 </street>
            <city>Mougins - Sophia Antipolis</city>
            <code>06254</code>
          <country>France</country>
         </postal>
         <phone>+33 497 23 26 34</phone>
         <email>pthubert@cisco.com</email>
      </address>
   </author>

    <author initials="D." surname="Barthel" fullname="Dominique Barthel">
      <organization>Orange Labs</organization>
      <address>
        <postal>
          <street ascii="28 chemin du Vieux Chene">28 chemin du Vieux Chêne</street>
          <code>38243</code>
          <city>Meylan</city>
          <country>France</country>
        </postal>
        <email>dominique.barthel@orange.com</email>
      </address>
    </author>

    <author fullname="Rahul Arvind Jadhav" initials="R.A." surname="Jadhav">
        <organization>Huawei Tech</organization>
        <address>
            <postal>
                <street>Kundalahalli Village, Whitefield,</street>
                <city>Bangalore</city>
                <region>Karnataka</region>
                <code>560037</code>
                <country>India</country>
            </postal>
            <phone>+91-080-49160700</phone>
            <email>rahul.ietf@gmail.com</email>
        </address>
    </author>

   <date/>
   <area>Routing Area</area>
   <workgroup>ROLL</workgroup>
   <keyword>Draft</keyword>
   <abstract>
      <t>
      This document presents a method to elide a group of critical RPL options.
      Whenever one information is changed in any of those options, a new
      sequence counter is incremented. It is then used to resynchronize the
      configuration state between parents and children. A node that missed a
      DIO message with an update of any of those fields detects it by the
      change of sequence counter and queries the update with a DIS Message.
      </t>
   </abstract>
</front>

<middle>
<section><name>Introduction</name>
   <t>
   Classical Link State protocol synchronize their Link State Database (LSDB) by
   sequencing every change. Each interested node maintains the last sequence
   of the LSDB it is synchronizing with. If a last known sequence is older than
   the current, the node needs to learn one by one all the state changes between
   the last known and the current state.
   </t><t>
   <xref target="RFC6550"/> does not operate that way. With RPL, the routing
   information is repeated over and over in DODAG Information Object (DIO) and
   Destination Advertisement Object (DAO) messages. There is no concept of
   synchronization. The most recent information overrides a previous one and
   a stale state eventually times out.
   </t><t>
   The RPL way was designed to enable routing from most to most most of the time
   in a Low-Power Lossy Network (LLN) where the quality of the link and the cost
   of communications does not permit to maintain a permanent synchronization.
   This principle was applied to both the routing information and other state
   such as configuration settings, prefix information, and node capabilities.
   </t><t>
   This other state may be needed to decide whether a node can join a network as
   a leaf or as a router, and may affect the parent selection.
   <xref target="RFC6550"/> allows a parent to elide that information in the DIO
   it sends repeatedly, but if it does so, a sleeping child may end up possessing only
   partial information (e.g., a prefix but not a configuration)
   and not possess all the necessary information. If it is pessimistic, it may
   query all possible information even when it is not needed. Conversely, a node
   that slept and missed DIO messages may miss a change in critical information
   and may not be aware of it, so it may fail to query the missing information
   when needed.
   </t><t>
   This document uses a new sequence counter to synchronize the state in a child
   node with that of its parent, and recursively with that of the network.
   </t>
</section><!-- title="Introduction"-->

<section><name>Terminology</name>
<section anchor='bcp'> <name>BCP 14</name>
   <t>
   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP 14
   <xref target="RFC2119"/><xref target="RFC8174"/> when, and only when,
   they appear in all capitals, as shown here.
   </t>
</section> <!-- BCP 14 -->


<section anchor='lo'> <name>References</name>


   <t>
   The Terminology used in this document is consistent with and incorporates
   that described in <xref target="RFC7102"> Terms Used in Routing for Low-Power
   and Lossy Networks (LLNs).</xref>.
   </t><t>
   Other terms in use in LLNs are found in <xref target="RFC7228">
   Terminology for Constrained-Node Networks</xref>.
   </t><t>
   A glossary of classical RPL acronyms is given in <xref target="gloss"/>.
   </t><t>
   The term “byte” is used in its now customary sense as a synonym for “octet”.
   </t><t>
   "RPL", "RPL Packet Information" (RPI) and "RPL Instance", DIO, DAO and DIS
   messages are defined in the
   <xref target="RFC6550">"RPL: IPv6 Routing Protocol for Low-Power and Lossy
   Networks"</xref> specification.
   </t><t>
   This document uses the terms RPL-Unaware Leaf (RUL) and RPL Aware Leaf
   (RAL) consistently with <xref target="I-D.ietf-roll-useofrplinfo" />.
   </t><t>
   The term RPL-Unaware Leaf (RUL) is used to refer to a node
   that uses a RPL router (without necessarily knowing it) as 6LR and depends on
   that router to obtain reachability for its addresses inside the RPL domain.
   On the contrary, the term RPL-Aware Node (RAN) is used to refer to a RAL
   or a RPL router that participates to RPL and advertises its addresses of
   prefixes by itself.
   </t>
<!--
<t>
    Readers are expected to be familiar with all the terms and concepts
    that are discussed in:
</t>
    <ul style="symbols">
    <li> <xref target="RFC6550">"RPL: IPv6 Routing Protocol for Low-Power and Lossy Networks"</xref>. </li>
    </ul>

-->
</section>	<!-- end section "References" -->
<section anchor='gloss'> <name>Glossary</name>
    <t> This document often uses the following acronyms:
    </t>
       <dl>
       <dt>DODAG</dt><dd>Destination-Oriented Directed Acyclic Graph </dd>
       <dt>LLN</dt><dd>Low-Power and Lossy Network </dd>
       <dt>RPI</dt><dd>RPL Packet Information (an Option in the Hop-By_Hop Header)</dd>
       <dt>RAL</dt><dd>RPL-Aware Leaf </dd>
       <dt>RAN</dt><dd>RPL-Aware Node, a RPL router or a RPL-Aware Leaf </dd>
       <dt>RS</dt><dd> Router Solicitation  </dd>
       <dt>RPL</dt><dd>IPv6 Routing Protocol for LLNs (pronounced ripple) </dd>
       <dt>RUL</dt><dd>RPL-Unaware Leaf </dd>
       </dl>
</section>	<!-- end section "Subset of a 6LoWPAN Glossary" -->

</section>	<!-- end section "Terminology" -->



<section><name>Updating RFC 6550</name>
   <t>
   This document adds a sequence counter called RPL Configuration State Sequence
   (RCSS) to the DIO message. The RCSS is set by the root and operated as
   specified in Section 7 of <xref target="RFC6550"/>, more in
   <xref target='rcss'/>.
   </t><t>
   This document introduces a new RPL Control Message Options called the
   Abbreviated Option Option (AOO). The AOO is an empty replacement of an
   existing option that indicates the RCSS of the last change of that option.
   </t><t>
   This document modifies the Solicited Information Option to enable the
   individual query of the protected options by a node that missed a change,
   more in <xref target='pullopts'/>.
   </t>
   </section><!-- Updating RFC 6550 -->


   <section  anchor='rcss'> <name>New RPL Configuration State Sequence</name>
   <t>
   The format of the DIO Base Object is defined in section 6.3.1 of
   <xref target="RFC6550"/>. This specification uses a 8th octet that was
   previously reserved to transport the RCSS.
   </t>
       <figure anchor="FigDIO">
              <name>MOdified DIO Base Object</name>
       <artwork align="center" name="" type="" alt="">
        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | RPLInstanceID |Version Number |             Rank              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |G|0| MOP | Prf |     DTSN      |     Flags     |      RCSS     |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       +                                                               +
       |                                                               |
       +                            DODAGID                            +
       |                                                               |
       +                                                               +
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Option(s)...
       +-+-+-+-+-+-+-+-+
       </artwork>
       </figure>

   <t>
   Updated fields:
   </t>
   <dl newline="true" spacing="normal" indent="3">
          <dt>RCSS</dt>
          <dd>One Byte, the RPL Configuration State Sequence </dd>
   </dl>
   <t>
   The RCSS protects network-wide options that are set by the root and that are
   propagated without a change down the DODAG. The RCSS MUST be incremented when
   the root sends a DIO where at least one of the protected options is modified.
   It MUST propagated down without a change together with the options that it
   protects.
   </t><t>
   During the straight part of the lollipop, a second reboot of the root might
   not be recognized and a same value of the RCSS may appear with new values in
   the protected options. For that reason the protected options MUST be present
   in the DIOs during the straight part of the lollipop and the root SHOULD move
   rapidly away from the straight part once the network has settled by resetting
   the RCSS to 0, which places the RCSS in the circular region of the lollipop.
   </t>
   </section> <!-- New RPL Configuration State Sequence -->


   <section  anchor='syopts'> <name>Protected Options</name>
   <t>The protected options are:
   </t>
   <ol>

   <li>The Route Information Option (RIO) defined in section 6.7.5 of <xref target="RFC6550"/></li>
   <li>The DODAG Configuration Option (DCO) defined in section 6.7.6 of <xref target="RFC6550"/></li>
   <li>The Prefix Information Option (PIO) defined in section 6.7.10 of <xref target="RFC6550"/></li>
   <li>The Extended MOP Option (MOPex) defined in
      <xref target="I-D.ietf-roll-mopex-cap" format="default"/></li>
   <li>The Global Capabilities Option (GCO) defined in
      <xref target="I-D.ietf-roll-mopex-cap" format="default"/></li>

   </ol>
   <t>
   When a protected option is unchanged from the previous DIOs, the root MAY
   replace it with its abbreviated version. The abbreviated version of an option
   is transported in a 4-bytes long Abbreviated Option Option (AOO). The AOO
   indicates the RCSS at which the protected option was last changed.
   </t>
       <figure anchor="FigABB">
              <name>Abbrev Option Format</name>
       <artwork align="center" name="" type="" alt="">

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |  Option Type  | Option Length | Abbrev. opt.  | Last mod RCSS |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

       </artwork>
       </figure>
   <t>
   Option fields:
   </t>
   <dl newline="true" spacing="normal" indent="3">
          <dt>Option Type</dt>
          <dd>One Byte, value indicating Abbreviated Option to be assigned by IANA </dd>
          <dt>Option Length</dt>
          <dd>MUST be set to 2 indicating Option data of 2 bytes</dd>
          <dt>Abbreviated Option</dt>
          <dd>The Option Type of the option being abreviated </dd>
          <dt>Last Modification RCSS</dt>
          <dd>The RCSS at which the option was last modified</dd>
   </dl>
   </section> <!-- Protected Options -->


   <section  anchor='childop'> <name>Child Operation</name>
   <t>
   When a field is modified in one of the protected options in a fashion that
   may affect the routing or forwarding decision inside the DODAG, the root
   MUST send a DIO with the protected options. Unchanged options may be
   abreviated as discussed in <xref target="syopts"/>.
   </t><t>
   The freshness of the protected options is asserted based on the RCSS.
   RCSS values are compared as described in section 7.2 of
   <xref target="RFC6550"/>. When a parent exposes a new RCSS, the child node
   SHOULD refrain from using that parent until it has resynchronized all the
   protected fields to the latest. When it is resynchronized, the child SHOULD
   refrain from using other parents that expose an older RCSS.
   </t><t>
   A child MUST keep track of the content of all the protected option and of the
   RCSS of the DIO where this option was last seen in a non-abbreviated version.
   If that RCSS is fresher than the Last Modification RCSS in the abbreviated
   version of the option then the child is up-to-date for that option.
   If a protected option elided in a DIO and not abbreviated, and the child has
   a stored RCSS value for that option that is lower than the RCSS in the DIO,
   then the child MUST query that option from the parent to ensure that is has
   the latest. This is done with a DIS message as indicated in
   <xref target="pullopts"/>.
   </t>
   </section> <!-- Child Operation -->


   <section  anchor='pullopts'> <name>Pulling Options</name>
   <t>
   </t>
   </section> <!-- Pulling Options -->



   <section anchor="SecurityConsiderations" numbered="true" toc="default">
       <name>Security Considerations</name>
   <t>TBD
   </t>
   </section>

   <section numbered="true" toc="default"> <name>IANA Considerations</name>

   <t>
   A new entries is required for the new option of type "Abbreviated Option",
   from the "RPL Control Message Options" space defined for
   <xref target="RFC6550"/>.
   </t>

   <table anchor="iana"><name>New Option</name>
   <thead>
      <tr><td>Value</td><td>Meaning</td><td>Reference</td></tr>
   </thead><tbody>
      <tr><td>TBD IANA</td><td>Abbreviated Option</td><td>THIS RFC</td></tr>
   </tbody>

   </table>
   </section>

   <section anchor='sec'><name>Security Considerations</name>
      <t>TBD
      </t>
   </section>



	<section><name>Acknowledgments</name>
		<t>

   		</t>
	</section><!-- ack -->
</middle>


<back>

   <displayreference   target="I-D.ietf-roll-mopex-cap"              to="MOPEX-CAP"/>
   <displayreference   target="RFC6550"                              to="RPL"/>

   <references><name>Normative References</name>
      <xi:include href='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml'/> <!-- BCP 14 -->
      <xi:include href='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml'/> <!-- BCP 14 update -->
      <xi:include href='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6550.xml'/> <!-- RPL -->
      <xi:include href='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7228.xml'/> <!-- Terminology for Constrained-Node Networks -->
      <xi:include href='http://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7102.xml'/> <!-- Terms Used in Routing for Low-Power and Lossy Networks -->
      <xi:include href='http://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-roll-mopex-cap.xml'/>
      <xi:include href='http://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-roll-useofrplinfo.xml'/>
   </references>
   <references><name>Informative References</name>


   </references>
</back>

</rfc>

<!-- CONVERT WARNING: wide character found at character 2041 of the output -->
